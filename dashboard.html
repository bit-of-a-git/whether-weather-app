<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Wheather Weather</title>
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"/>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400..800&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/style.css"/>
    <script src="/data/weather_data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script src="/js/getImageSource.js"></script>
  </head>
  <body>
<script>
  document.addEventListener("DOMContentLoaded", () => {

    const title = document.getElementById('title');
    title.innerHTML = 'Dashboard';
    const subtitle = document.getElementById('subtitle');
    subtitle.innerHTML = "Today";

    const now = dayjs(); // create a new date object that represents this time
    const currentHour = now.format("HH"); // 0 - 23 as a number

    // Gets a list of city names from weatherData, avoids duplication by only adding ones
    // ending in _hourly
    const cityList = Object.keys(weatherData).filter(key => key.endsWith("_daily"));

    cityList.forEach((city, index) => {
      const dailyData = weatherData[city].daily;
      const dailyUnits = weatherData[city].daily_units;

      // removes _hourly from the end to just get the city name
      const cityName = city.replace("_daily", "");
      // Print out the index and city name for each item

      const cityTitle = document.getElementById(`daySummary${index}`);
      cityTitle.innerHTML = cityName.toUpperCase().replace("_", " ");

      const cityWeatherImage = document.getElementById(`daySummaryImage${index}`)
      const cityWeatherCode = dailyData.weather_code[0];
      cityWeatherImage.src = getImageSource(cityWeatherCode);
    
      const cityLowTemp = document.getElementById(`daySummaryLowTemp${index}`)
      cityLowTemp.innerHTML = Math.round(dailyData.temperature_2m_min[0]) + dailyUnits.temperature_2m_min;
    
      const cityHighTemp = document.getElementById(`daySummaryHighTemp${index}`)
      cityHighTemp.innerHTML = Math.round(dailyData.temperature_2m_max[0]) + dailyUnits.temperature_2m_max;
    }
  )
  });
</script>

<div class="columns">
  <div class="column is-one-third mt-5">
    <img src="/images/logo.png"/>
  </div>
  <div class="column is-one-third mb-0 mt-auto has-text-centered has-text-black has-text-weight-bold">
    <p id="title" class="is-size-1"></p>
    <p id="subtitle" class="is-size-3"></p>
  </div>
</div>
<div class="columns is-centered has-text-white has-text-weight-bold">
<div class="column is-7">
  <div class="columns is-multiline is-centered is-vcentered">
  <div class="column is-3 m-3 p-1 has-background-black">
    <p id="daySummary0" class="is-size-4 has-text-centered"></p>
    <a class="link" href="/example"><img id="daySummaryImage0" class="px-5" src="/images/sun.png"/></a>
    <div class="columns is-vcentered">
      <div class="column is-half">
        <p id="daySummaryLowTemp0" class="is-size-4 has-text-left"></p>
      </div>
      <div class="column is-half">
        <p id="daySummaryHighTemp0" class="is-size-4 has-text-right"></p>
      </div>
    </div>
  </div>
  <div class="column is-3 m-3 p-1 has-background-black">
    <p id="daySummary1" class="is-size-4 has-text-centered">Today</p>
    <img id="daySummaryImage1" class="px-5" src="/images/sun.png"/>
    <div class="columns is-vcentered">
      <div class="column is-half">
        <p id="daySummaryLowTemp1" class="is-size-4 has-text-left">6°C</p>
      </div>
      <div class="column is-half">
        <p id="daySummaryHighTemp1" class="is-size-4 has-text-right">12°C</p>
      </div>
    </div>
  </div>
  <div class="column is-3 m-3 p-1 has-background-black">
    <p id="daySummary2" class="is-size-4 has-text-centered">Today</p>
    <img id="daySummaryImage2" class="px-5" src="/images/sun.png"/>
    <div class="columns is-vcentered">
      <div class="column is-half">
        <p id="daySummaryLowTemp2" class="is-size-4 has-text-left">6°C</p>
      </div>
      <div class="column is-half">
        <p id="daySummaryHighTemp2" class="is-size-4 has-text-right">12°C</p>
      </div>
    </div>
  </div>
  <div class="column is-3 m-3 p-1 has-background-black">
    <p id="daySummary3" class="is-size-4 has-text-centered">Today</p>
    <img id="daySummaryImage3" class="px-5" src="/images/sun.png"/>
    <div class="columns is-vcentered">
      <div class="column is-half">
        <p id="daySummaryLowTemp3" class="is-size-4 has-text-left">6°C</p>
      </div>
      <div class="column is-half">
        <p id="daySummaryHighTemp3" class="is-size-4 has-text-right">12°C</p>
      </div>
    </div>
  </div>
  <div class="column is-3 m-3 p-1 has-background-black">
    <p id="daySummary4" class="is-size-4 has-text-centered">Today</p>
    <img id="daySummaryImage4" class="px-5" src="/images/sun.png"/>
    <div class="columns is-vcentered">
      <div class="column is-half">
        <p id="daySummaryLowTemp4" class="is-size-4 has-text-left">6°C</p>
      </div>
      <div class="column is-half">
        <p id="daySummaryHighTemp4" class="is-size-4 has-text-right">12°C</p>
      </div>
    </div>
  </div>
  <div class="column is-3 m-3 p-1 has-background-black">
    <p id="daySummary5" class="is-size-4 has-text-centered">Today</p>
    <img id="daySummaryImage5" class="px-5" src="/images/sun.png"/>
    <div class="columns is-vcentered">
      <div class="column is-half">
        <p id="daySummaryLowTemp5" class="is-size-4 has-text-left">6°C</p>
      </div>
      <div class="column is-half">
        <p id="daySummaryHighTemp5" class="is-size-4 has-text-right">12°C</p>
      </div>
    </div>
  </div>
</div>
</div>
</div>
  </body>
</html>